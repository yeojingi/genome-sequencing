AminoAcidMass = {'G': 57, 'A': 71, 'S': 87, 'P': 97, 'V': 99, 'T': 101, 'C': 103, 'I': 113,
    'L': 113, 'N': 114, 'D': 115, 'K': 128, 'Q': 128, 'E': 129, 'M': 131,
    'H': 137, 'F': 147, 'R': 156, 'Y': 163, 'W': 186}

def linear_scoring(peptide, spectrum):
  L = len(peptide)
  list_spectrum = list(map(int, spectrum.split(' ')))
  S = len(list_spectrum)

  def mass(window):
    ans = 0
    
    for aa in window:
      ans += AminoAcidMass[aa]
    
    return ans

  for k in range(L+1):
    for i in range(L - k + 1):
      window = peptide[i:i+k]
      m = mass(window)

      try:
        list_spectrum.remove(m)
      except ValueError as e:
        pass
      
  
  ans = S - len(list_spectrum)
  
  return ans

print(linear_scoring("HECCEGGGCFRIVNNWCYCDDKHNGTKIAIHQAYRLQSP",
"0 57 57 57 71 71 71 87 97 97 101 101 103 103 103 103 113 113 113 113 114 114 114 114 115 115 115 128 128 128 128 129 129 137 137 137 147 156 156 158 163 171 184 184 184 184 185 186 186 199 202 206 214 215 216 217 218 218 225 229 230 232 232 234 241 242 243 243 244 250 251 257 259 265 265 266 269 270 272 282 285 287 289 297 300 303 308 312 315 319 321 328 331 332 332 333 335 335 336 339 346 358 362 369 370 371 371 372 372 373 378 379 380 385 386 390 392 397 398 400 402 403 409 417 425 429 432 434 436 443 446 446 449 449 449 461 464 468 472 473 474 474 484 484 486 486 488 494 495 499 499 503 510 514 517 518 518 520 521 528 532 535 537 551 556 557 560 562 571 574 577 578 581 585 587 587 588 589 598 601 602 609 612 615 623 629 631 631 632 633 635 636 638 642 642 645 647 652 655 658 663 666 670 674 683 690 693 694 699 702 702 703 703 706 711 712 715 718 718 732 734 744 749 751 753 756 757 759 764 767 768 768 769 771 782 788 796 803 805 805 807 807 814 815 816 817 821 821 822 825 831 835 839 843 846 846 859 860 866 868 870 871 874 881 882 885 892 896 896 897 917 919 920 920 935 935 935 937 940 943 944 945 950 952 952 953 968 971 972 974 974 977 981 983 983 988 998 1000 1006 1006 1009 1031 1032 1034 1035 1048 1050 1052 1053 1054 1055 1065 1072 1072 1075 1080 1080 1082 1082 1084 1084 1087 1088 1091 1096 1103 1103 1103 1106 1119 1139 1143 1149 1154 1155 1155 1160 1163 1165 1166 1167 1169 1185 1187 1190 1193 1193 1196 1197 1200 1206 1206 1211 1216 1217 1217 1220 1222 1231 1240 1243 1253 1264 1267 1268 1268 1268 1271 1274 1277 1280 1288 1294 1299 1300 1302 1305 1306 1309 1315 1319 1320 1324 1325 1335 1337 1339 1341 1344 1345 1354 1356 1357 1377 1381 1381 1386 1395 1401 1403 1405 1414 1414 1423 1430 1433 1434 1434 1438 1438 1447 1452 1452 1452 1454 1455 1457 1458 1462 1471 1472 1474 1478 1482 1501 1504 1506 1518 1525 1528 1533 1539 1549 1549 1552 1558 1561 1562 1566 1568 1570 1572 1575 1575 1577 1579 1580 1585 1587 1589 1590 1604 1609 1619 1636 1638 1639 1646 1653 1664 1671 1673 1676 1677 1677 1680 1684 1686 1689 1690 1690 1703 1703 1705 1717 1717 1717 1734 1738 1741 1742 1750 1752 1767 1775 1786 1787 1788 1790 1791 1793 1793 1805 1805 1809 1814 1818 1820 1831 1831 1842 1855 1857 1862 1875 1880 1887 1888 1889 1896 1900 1903 1908 1918 1919 1920 1922 1923 1928 1933 1942 1943 1946 1946 1951 1970 1971 1974 1985 1989 1992 1999 2011 2015 2017 2023 2025 2033 2036 2036 2048 2056 2056 2056 2059 2061 2084 2086 2088 2090 2107 2107 2113 2113 2120 2126 2127 2130 2137 2140 2148 2149 2151 2162 2164 2170 2170 2185 2187 2191 2203 2214 2220 2221 2227 2235 2240 2245 2251 2251 2254 2255 2271 2274 2277 2277 2288 2293 2299 2300 2306 2315 2328 2348 2348 2349 2354 2356 2364 2371 2372 2377 2383 2387 2391 2392 2402 2406 2407 2420 2428 2429 2435 2457 2459 2461 2469 2484 2485 2499 2505 2505 2510 2520 2520 2520 2524 2532 2534 2542 2556 2558 2560 2562 2576 2583 2612 2613 2621 2621 2623 2625 2634 2648 2652 2657 2661 2663 2669 2671 2691 2718 2723 2726 2735 2738 2739 2739 2742 2749 2749 2751 2764 2771 2774 2792 2806 2820 2828 2832 2838 2845 2852 2855 2863 2866 2877 2877 2886 2893 2895 2929 2934 2935 2948 2948 2953 2958 2980 2983 2991 2992 3005 3006 3008 3030 3042 3050 3061 3062 3067 3077 3095 3111 3120 3136 3139 3143 3155 3164 3168 3190 3191 3198 3214 3223 3223 3225 3252 3267 3283 3294 3320 3324 3326 3327 3327 3354 3370 3380 3380 3381 3397 3437 3455 3457 3464 3467 3467 3494 3508 3510 3526 3560 3564 3565 3592 3595 3613 3622 3623 3652 3663 3689 3692 3709 3716 3726 3749 3751 3806 3826 3829 3838 3845 3854 3935 3941 3957 3958 3982 4038 4044 4086 4095 4141 4173 4223 4270 4310 4407"))


